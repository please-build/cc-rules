[please]
version = >=17.19.1

[Plugin "go"]
Target = //plugins:go
GoTool = //third_party/go:toolchain|go
Stdlib = //third_party/go:std
ImportPath = github.com/please-build/cc-rules
RequireLicences = true

[Plugin "e2e"]
Target = //plugins:e2e
DefaultPlugin = //test:cc-rules

[PluginDefinition]
name = cc

[PluginConfig "coverage"]
ConfigKey = Coverage
DefaultValue = true
Type = bool
Inherit = true
Help = If true, generates a "cover" build configuration for c_test and cc_test that outputs coverage analysis alongside test results.

[PluginConfig "coverage_tool"]
ConfigKey = CoverageTool
DefaultValue = gcov
Inherit = true
Help = The path or build target for the C coverage analysis tool.

[PluginConfig "cc_tool"]
ConfigKey = CCTool
DefaultValue = gcc
Inherit = true
Help = The path or build target for the C compiler tool.

[PluginConfig "cpp_tool"]
ConfigKey = CPPTool
DefaultValue = g++
Inherit = true
Help = The path or build target for the C++ compiler tool.

[PluginConfig "ar_tool"]
ConfigKey = ARTool
DefaultValue = ar
Inherit = true
Help = The path or build target for the archiver tool.

[PluginConfig "please_cc_tool"]
ConfigKey = PleaseCCTool
DefaultValue = //tools:please_cc
Help = The path or build target for the please_cc tool, an internal tool used by the build definitions to invoke C/C++ compilers and linkers with appropriate command line arguments.
Inherit = true

[PluginConfig "default_opt_cflags"]
ConfigKey = DefaultOptCFlags
Repeatable = true
DefaultValue = -std=c99
DefaultValue = -O3
DefaultValue = -pipe
DefaultValue = -DNDEBUG
DefaultValue = -Wall
DefaultValue = -Werror
Inherit = true
Help = The default flags to pass to the C compiler when compiling a release build.

[PluginConfig "default_dbg_cflags"]
ConfigKey = DefaultDbgCFlags
Repeatable = true
DefaultValue = -std=c99
DefaultValue = -g3
DefaultValue = -pipe
DefaultValue = -DDEBUG
DefaultValue = -Wall
DefaultValue = -Werror
Inherit = true
Help = The default flags to pass to the C compiler when compiling a debug build.

[PluginConfig "default_opt_cppflags"]
ConfigKey = DefaultOptCppFlags
Repeatable = true
DefaultValue = -std=c++11
DefaultValue = -O3
DefaultValue = -pipe
DefaultValue = -DNDEBUG
DefaultValue = -Wall
DefaultValue = -Werror
Inherit = true
Help = The default flags to pass to the C++ compiler when compiling a release build.

[PluginConfig "default_dbg_cppflags"]
ConfigKey = DefaultDbgCppFlags
Repeatable = true
DefaultValue = -std=c++11
DefaultValue = -g3
DefaultValue = -pipe
DefaultValue = -DDEBUG
DefaultValue = -Wall
DefaultValue = -Werror
Inherit = true
Help = The default flags to pass to the C++ compiler when compiling a debug build.

[PluginConfig "default_ldflags"]
ConfigKey = DefaultLdFlags
Repeatable = true
DefaultValue = -lpthread
DefaultValue = -ldl
Inherit = true
Help = The default flags to pass to the linker.

[PluginConfig "enable_gc"]
ConfigKey = EnableGC
Type = bool
DefaultValue = false
Inherit = true
Help = If true, enables link-time garbage collection for binary outputs in release builds. This removes unused code and data, usually resulting in smaller file sizes.

[PluginConfig "pkg_config_path"]
ConfigKey = PkgConfigPath
DefaultValue =
Inherit = true
Help = A path in which pkg-config should search for .pc files. This is used whenever the pkg_config_libs or pkg_config_cflags parameters are passed to the plugin's build rules.

[PluginConfig "test_main"]
ConfigKey = TestMain
Inherit = true
DefaultValue = //unittest-pp:main
Help = A build target for the source code that defines the entry point for C++ tests (see the cc_test build rule).

[PluginConfig "dsym_tool"]
ConfigKey = DsymTool
Inherit = true
DefaultValue =
Help = The path or build target for dsymutil. If set, a .dSYM file containing symbol information is additionally outputted when compiling a debug build.

[PluginConfig "default_namespace"]
ConfigKey = DefaultNamespace
DefaultValue =
Help = The default namespace in which to compile C++ code.

[PluginConfig "default_strip"]
ConfigKey = DefaultStrip
Type = bool
Inherit = true
DefaultValue = true
Help = If true, strip all symbol information from non-test binary outputs in release builds by default.

[PluginConfig "feature_flags"]
DefaultValue =
Repeatable = true
Optional = true
Inherit = true
Help = Flags to enable in-development features, or toggle breaking changes.
